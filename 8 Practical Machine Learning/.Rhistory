fitno <- lm(out2$y[-1,] ~ out2$x[-1,])
fitno <- lm(y ~ x, out2[-1,])
plot(fitno, which = 1)
coef(fit) - coef(fitno)
head(dfbeta(fit))
resno <- out2[1, "y"] - predict(fitno, out2[1,])
1-resid(fit)/resno
1-resid(fit)[1/resno
1-resid(fit)[1/resno]
1-resid(fit)[1]/resno
head(hatvalues(fit))
sigma <- sqrt(sd(resid(fit))/2)
sigma <- sqrt(deviance(fit)/df.residual(fit))
rstd <- resid(fit)/(sigma*sqrt(1-hatvalues(fit)))
head(cbind(rstd, rstandard(fit)))
plot(fit, which = 3)
plot(fit, which = 2)
sigma1 <- sqrt(deviance(fitno) / df.residual(fitno))
resid(fit)[1] / (sigma1*sqrt(1 - hatvalues(fit)[1]))
rstudent(fit)[1]
head(rstudent(fit))
dy <- predcit(fit, out2) - predict(fitno, out2)
dy <- predict(fit, out2) - predict(fitno, out2)
dy/(2*sigm^2)
dy/(2*sigma^2)
sum(dy^2)/(2*sigma^2)
plot(fit, which = 5)
rm(list = ls())
"manipulate" %in% installec.packages()
"manipulate" %in% installed.packages()
install.packages(manipulate)
install.packages("manipulate")
"manipulate" %in% installed.packages()
"reticulate" %in% installed.packages()
install.packages("savewav")
?fft
n <- seq(0:4*pi, by = 0.01)
n <- seq(0:(4*pi), by = 0.01)
n <- seq(0, (4*pi), by = 0.01)
fft(n)
plot(fft(n))
rnomr()
rnomr(1)
rnorm()
rnorm(1)
n <- sqe(0, 4*pi, by = 0.05)
x <- vector()
for(i in 1:10){
for(j in 1:n){
x[j] <- x[j] + sin(10*rnorm(1))
}
}
rm(list = ls())
library(swirl)
swirl()
apply()
apply
?apply
rgp1()
rgp2()
force(swiss)
View(swiss)
mdl <- lm(Fertility ~ ., swiss)
vif(mdl)
mdl2 <- lm(Fertility ~ . - Examination, swiss)
vif(mdl2)
?rnorm
simbias()
x1c <- simbias()
apply(x1c, 1, mean)
fit1 <- lm(Fertility ~ Agriculture, swiss)
fit3 <- lm(Fertility ~ Agriculture + Examination + Education, swiss)
anova(fit1, fit3)
deviance(fit3)
d
d <- deviance(fit3)/43
n <- (deviance(fit1) - deviance(fit3)) / 2
n/d
pf(n/d, 2, 43, lower.tail = FALSE)
anova
shapiro.test(fit3$residuals)
anova(fit1, fit3, fit5, fit6)
library(readr)
Cris_poletto_Campanhas_21_de_Jan_de_2022_4_de_Fev_de_2022 <- read_csv("Cris-poletto-Campanhas-21-de-Jan-de-2022-4-de-Fev-de-2022.csv")
View(Cris_poletto_Campanhas_21_de_Jan_de_2022_4_de_Fev_de_2022)
rm(list = ls())
library(readr)
AV_Cris_Poletto <- read_csv("AV-Cris-Poletto.csv")
View(AV_Cris_Poletto)
str(AV_Cris_Poletto)
names(AV_Cris_Poletto) <- c("campanha", "conjunto de anuncios", "anuncio", "idade", "dia",
"valor-gasto", "tipo resultado", "resultado", "CPR", "cliques",
"CTR", "CPC", "alcance", "impressoes", "frequencia",
"CPM", "engajamento publi", "thruplays", "reproducao 25%", "reproducao 50%",
"reproducao 75%", "inicio", "fim")
write.csv(AV_Cris_Poletto, file = "crispoletto-feb-jan")
write.csv(AV_Cris_Poletto, file = "crispoletto-feb-jan.csv")
?stri_enc_toutf8
?stri_enc_toutf8
apply(X = AV_Cris_Poletto, 2, FUN = stri_enc_toutf8)
require(stringi)
apply(X = AV_Cris_Poletto, 2, FUN = stri_enc_toutf8)
head(stri_enc_toutf8(AV_Cris_Poletto$`tipo resultado`),10)
identical(stri_enc_toutf8(AV_Cris_Poletto$`tipo resultado`), AV_Cris_Poletto$`tipo resultado`)
stri_enc_mark(AV_Cris_Poletto$`tipo resultado`)
stri_encode(AV_Cris_Poletto$`tipo resultado`, "", "UTF-8")
AV_Cris_Poletto$`tipo resultado`<-stri_encode(AV_Cris_Poletto$`tipo resultado`, "", "UTF-8")
AV_Cris_Poletto$anuncio <- stri_encode(AV_Cris_Poletto$anuncio, "", "UTF-8")
>
AV_Cris_Poletto$anuncio <- stri_encode(AV_Cris_Poletto$anuncio, "", "UTF-8")
write.csv(AV_Cris_Poletto, file = "crispoletto-feb-jan.csv")
CP <- AV_Cris_Poletto
?FindReplace
require(DataCombine)
install.packages("DataCombine")
?FindReplace
library(DataCombine)
?FindReplace
repacedata <- data.frame(from = c("ç", "ã"), to = c("c", "a"))
"caret" %in% installed.packages()
"caret" %in% installed.packages()
n <- 1:200
cr7 <- rnorm(n, mean = 0.01*n, sd = 1)
plot(n,cr7)
fit <- lm(cr7 ~ n)
library(ggplot2)
ggplot(fit,
aes(x = n,
y = cr7),
fill = "red") +
geom_smooth(method = "lm")
ggplot(fit,
aes(x = n,
y = cr7)) +
geom_points() +
geom_smooth(method = "lm")
ggplot(fit,
aes(x = n,
y = cr7)) +
geom_point(color = "red") +
geom_smooth(method = "lm")
par(mfrow(2,1))
par(mfrow = c(2,1))
cr7 <- rnorm(n, mean = 0.015*n, sd = 0.1)
ney <- rnorm(n, mean = 0.01*n, sd = 1.5)
fit2 <- lm(ney ~ n)
ggplot(fit,
aes(x = n,
y = cr7)) +
geom_point(color = "red") +
geom_smooth(method = "lm")
ggplot(fit2,
aes(x = n,
y = ney)) +
geom_point(color = "blue") +
geom_smooth(method = "lm")
par(mfrow = c(2,1))
ggplot(fit,
aes(x = n,
y = cr7)) +
geom_point(color = "red") +
geom_smooth(method = "lm")
ggplot(fit2,
aes(x = n,
y = ney)) +
geom_point(color = "blue") +
geom_smooth(method = "lm")
"ggpubr" %in% installed.packages()
install.packages("ggpubr")
library(ggpubr)
ney_plot <- ggplot(fit2,
aes(x = n,
y = ney)) +
geom_point(color = "blue") +
geom_smooth(method = "lm")
cr7_plot <- ggplot(fit,
aes(x = n,
y = cr7)) +
geom_point(color = "red") +
geom_smooth(method = "lm")
ggarrange(cr7_plot, ney_plot, nrow = 2)
ney_plot <- ggplot(fit2,
aes(x = n,
y = ney)) +
geom_point(color = "blue") +
geom_smooth(method = "lm", color = "yellow")
ggarrange(cr7_plot, ney_plot, nrow = 2)
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.015*n, sd = 0.01), ney = rnorm(n, mean = 0.01*n, sd = 1.5))
View(football)
ft_melted <- melt(as.data.frame(football), id = "n")
install.packages("reshape2")
library(reshape2)
ft_melted <- melt(as.data.frame(football), id = "n")
View(ft_melted)
ggplot(ft_melted,
aes(x = n,
y = value),
fill = variable) +
geom_point()
ggplot(ft_melted,
aes(x = n,
y = value),
color = variable) +
geom_point()
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point()
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.02*n, sd = 0.1), ney = rnorm(n, mean = 0.01*n, sd = 1))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point()
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm",
color = variable)
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm",
stat = "identity")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm",
fill = variable)
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.015*n, sd = 0.3), ney = rnorm(n, mean = 0.01*n, sd = 1))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
theme(xlab = "Numero de partidas jogadas",
ylab = "Performance")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.015*n, sd = 0.3), ney = rnorm(n, mean = 0.012*n, sd = .8))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 1, sd = 0.3), ney = rnorm(n, mean = 1, sd = .8))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 1, sd = 0.3), ney = rnorm(n, mean = 1, sd = .8))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.0012*n, sd = 0.3), ney = rnorm(n, mean = 0.001*n, sd = .8))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.0022*n, sd = 0.3), ney = rnorm(n, mean = 0.002*n, sd = .8))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.0035*n, sd = 0.3), ney = rnorm(n, mean = 0.003*n, sd = .8))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.0035*n + 0.3, sd = 0.3), ney = rnorm(n, mean = 0.003*n, sd = .8))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.0035*n + 0.3, sd = 0.3), ney = rnorm(n, mean = 0.003*n, sd = .6))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.0035*n + 0.25, sd = 0.3), ney = rnorm(n, mean = 0.003*n, sd = .6))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
football <- data.frame(n = 1:200, cr7 = rnorm(n, mean = 0.004*n + 0.25, sd = 0.3), ney = rnorm(n, mean = 0.003*n, sd = .6))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance",
fill = "Jogador")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance",
legend = "Jogador")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance",
color = "Jogador")
"caret" %in% installed.packages()
library(caret)
library("caret")
install.packages("caret")
library(caret)
change()
change <- function(){
football <- data.frame(n = 1:200,
cr7 = rnorm(n, mean = 0.004*n + 0.25, sd = 0.3),
ney = rnorm(n, mean = 0.003*n, sd = .6))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance",
color = "Jogador")
}
change()
change <- function(){
n <- 1:200
football <- data.frame(n = 1:200,
cr7 = rnorm(n, mean = 0.004*n + 0.25, sd = 0.3),
ney = rnorm(n, mean = 0.003*n, sd = .6))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Numero de partidas jogadas",
y = "Performance",
color = "Jogador")
}
change()
library(ggplot2)
library(reshape2)
change()
change()
change <- function(){
n <- 1:200
football <- data.frame(n = 1:200,
cr7 = rnorm(n, mean = 0.004*n + 0.25, sd = 0.3),
neymar = rnorm(n, mean = 0.003*n, sd = .6))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Número de partidas jogadas",
y = "Performance",
color = "Jogador")
}
change()
change()
change <- function(){
n <- 1:200
football <- data.frame(n = 1:200,
CR7 = rnorm(n, mean = 0.004*n + 0.25, sd = 0.3),
neymar = rnorm(n, mean = 0.003*n, sd = .6))
ft_melted <- melt(as.data.frame(football), id = "n")
ggplot(ft_melted,
aes(x = n,
y = value,
color = variable)) +
geom_point() +
geom_smooth(method = "lm") +
labs(x = "Número de partidas jogadas",
y = "Performance",
color = "Jogador")
}
change()
setwd("~/GitHub/JHU_Data_Science/8 Practical Machine Learning")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(caret)
library(dplyr)
trainURL <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
testURL <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"
trainset <- download.file(trainURL,
destfile = "trainingset.csv") %>%
read.csv()
read.csv("trainingset.csv")
trainURL <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
testURL <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"
download.file(trainURL,
destfile = "trainingset.csv")
download.file(testURL,
destfile = "testset.csv")
train_set <- read.csv("trainingset.csv")
test_set <- read.csv("testset.csv")
head(train_set, 110)
View(test_set)
View(train_set)
train_set <- read.csv("trainingset.csv",
na.strings = c("", "#DIV/0!", "NA"))
trainURL <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
testURL <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"
download.file(trainURL,
destfile = "trainingset.csv")
download.file(testURL,
destfile = "testset.csv")
train_set <- read.csv("trainingset.csv",
na.strings = c("", "#DIV/0!", "NA"))
test_set <- read.csv("testset.csv",
na.strings = c("", "#DIV/0!", "NA"))
